<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Recording</title>
<<<<<<< HEAD
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      #background {
          top: 0;
          left: 0;
          position: fixed;
          width: 100%;
          height: 100%;
          background-color: rgb(0, 45, 100);
          z-index: -1;
      }
      h1 {
          position: relative;
          color: white;
          text-align: center;
          font-size: 5vh;
          font-family: Arial, Helvetica, sans-serif;
      }
      iframe {
          position: relative;
          width: 50%;
          height: 90vh;
          overflow:hidden;  
      }
      h3 {
          position: relative;
          float: left;
          font-family: 'Inconsolata', Consolas, monospace;
          font-size: 2em;
      }
      h3 span{
        position: absolute;
        top: 0;
        right: 0;
        background: rgb(0, 45, 100);
        width: 100%;
        border-left: .1em solid transparent;
        -webkit-animation: typing 3s steps(16) forwards,
                          cursor 1s infinite;
        animation: typing 3s steps(16) forwards,
                  cursor 1s infinite;
      }
      /* Animation */
      @-webkit-keyframes typing{
        from { width: 100%;}
        to { width: 0;}
      }
      @-webkit-keyframes cursor{
        50% { border-color: white;}
      }
      @keyframes typing{
        from{ width: 100%;}
        to{ width: 0;}
      }
      @keyframes cursor{
        50% { border-color: white;}
      }
  </style>
  </head>
  <body>
	    <div id="background"></div>
      <h1>Speech Emotion Recognition</h1>
        
    
=======
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.6.2/plyr.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>li.nostyle {
      list-style-type: none;
  }
  a.dark{
  color:#007BFF;}
  :root{
    --plyr-color-main: #007BFF;
  }
  </style>
  </head>
  <body>
    <div class="container marketing" style="color: #269ef5;">
      <h1>Emotion AI Recording <img src='https://i.imgur.com/GnSrTyD.png'></h1>
      <br />
>>>>>>> 4ad5f474bee3cc8a3631b7474bee2eea71050623

      <div id="controls">
        <button
          id="recordButton"
          type="button"
          class="btn btn-primary"
          style="background-color: #269ef5; border: none;"
        >
          Record
        </button>
        <button
          id="pauseButton"
          type="button"
          class="btn btn-primary"
          style="background-color: #269ef5; border: none;"
          disabled
        >
          Pause
        </button>
        <button
          id="stopButton"
          type="button"
          class="btn btn-primary"
          style="background-color: #269ef5; border: none;"
          disabled
        >
          Stop
        </button>
      </div>
      <div id="formats">Format: start recording to see sample rate</div>
      <br />
      <p><strong>Recordings:</strong></p>
      <ol id="recordingsList" ></ol>
    </div>
<<<<<<< HEAD
    <div id="formats" style='color: white'>Format: start recording to see sample rate</div>
    <div id='error' style='color: red'></div>
    <p style='color: white'><strong>Recordings:</strong></p>
    <ol id="recordingsList"></ol>

    <center>
      <img src="C:\Users\manuh\Emotion-Recognition-AI\robot.png"></img>
      </center>
      <div id='chat'></div>
    
=======
>>>>>>> 4ad5f474bee3cc8a3631b7474bee2eea71050623
    <script src="https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js"></script>

    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"
      integrity="sha384-1CmrxMRARb6aLqgBO7yyAxTOQE2AKb9GfXnEo760AUcUmFx3ibVJJAzGytlQcNXd"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script src="https://kit.fontawesome.com/52bbfb2555.js" crossorigin="anonymous"></script>
    <script src="https://cdn.plyr.io/3.6.2/plyr.js"></script>
    <script>
     
      URL = window.URL || window.webkitURL;

      var gumStream;
      var rec;
      var input;

      var AudioContext = window.AudioContext || window.webkitAudioContext;
      var audioContext;

      var recordButton = document.getElementById("recordButton");
      var stopButton = document.getElementById("stopButton");
      var pauseButton = document.getElementById("pauseButton");

      recordButton.addEventListener("click", startRecording);
      stopButton.addEventListener("click", stopRecording);
      pauseButton.addEventListener("click", pauseRecording);

      function startRecording() {
        console.log("recordButton clicked");

        var constraints = { audio: true, video: false };

        recordButton.disabled = true;
        stopButton.disabled = false;
        pauseButton.disabled = false;

        navigator.mediaDevices
          .getUserMedia(constraints)
          .then(function (stream) {
            console.log(
              "getUserMedia() success, stream created, initializing Recorder.js ..."
            );

            audioContext = new AudioContext();

            document.getElementById("formats").innerHTML =
              "Format: 1 channel pcm @ " +
              audioContext.sampleRate / 1000 +
              "kHz";

            gumStream = stream;

            input = audioContext.createMediaStreamSource(stream);

            rec = new Recorder(input, { numChannels: 1 });

            rec.record();

            console.log("Recording started");
          })
          .catch(function (err) {
            recordButton.disabled = false;
            stopButton.disabled = true;
            pauseButton.disabled = true;
          });
      }

      function pauseRecording() {
        console.log("pauseButton clicked rec.recording=", rec.recording);
        if (rec.recording) {
          rec.stop();
          pauseButton.innerHTML = "Resume";
        } else {
          rec.record();
          pauseButton.innerHTML = "Pause";
        }
      }

      function stopRecording() {
        console.log("stopButton clicked");

        stopButton.disabled = true;
        recordButton.disabled = false;
        pauseButton.disabled = true;

        pauseButton.innerHTML = "Pause";

        rec.stop();

        gumStream.getAudioTracks()[0].stop();

        rec.exportWAV(createDownloadLink);
      }

      function createDownloadLink(blob) {
        var url = URL.createObjectURL(blob);
        var au = document.createElement('audio')
       var space = document.createElement('a')
        var li = document.createElement("li");
        var link = document.createElement("a");

        var filename = new Date().toISOString();

        
        au.controls = true;
        au.src = url;
        au.id='player';
        space.innerHTML='&nbsp;'
        link.href = url;
        link.download = filename + ".wav";
        link.innerHTML = 'Save to disk ';

       
        li.classList.add('nostyle')
        li.appendChild(au);
      
      //  li.appendChild(document.createTextNode(filename + ".wav "));
        li.appendChild(space);
        li.appendChild(link);
        li.appendChild(space);
        
        var upload = document.createElement("a");
        upload.href = "#";
        upload.innerHTML = 'Upload';
        upload.addEventListener("click", function (event) {
          var xhr = new XMLHttpRequest();
          xhr.onload = function (e) {
            if (this.readyState === 4) {
              console.log("Server returned: ", e.target.responseText);
            }
          };
          console.log(blob);
          var fd = new FormData();
          fd.append("audio_data", blob, filename);
          xhr.open("POST", "/", true);
          xhr.send(fd);
        });
        li.appendChild(document.createTextNode(" "));
        li.appendChild(upload);
        var emotion = document.createElement('a');
        
        emotion.innerHTML+='&nbsp;&nbsp;Emotion:'
        emotion.classList.add('dark');
        
        emotion.addEventListener('click',function(){console.log('emotion')})
        li.appendChild(space);
        const player = new Plyr(au);
        var remove = document.createElement('a');
        remove.innerHTML ='Delete';
        remove.href='#'
        remove.onclick=function(){ $(li).remove();}
       
        li.appendChild(remove);
        li.appendChild(emotion)
        recordingsList.appendChild(li);
      }
    </script>
  </body>
</html>
